<h2>
  @if (isEditMode()) {
    Editar Funcionário
  } @else {
    Cadastrar Novo Funcionário
  }
</h2>

@if (isLoading()) {
  <p>Carregando...</p>
} @else {
  <form [formGroup]="funcionarioForm" (ngSubmit)="onSubmit()">

    <div class="form-group">
      <label for="nome">Nome:</label>
      <input id="nome" type="text" formControlName="nome">

      @if (nome?.invalid && (nome?.dirty || nome?.touched)) {
        <div class="form-error">
          @if (nome?.errors?.['required']) { <span>Nome é obrigatório.</span> }
          @if (nome?.errors?.['minlength']) { <span>Nome deve ter no mínimo 3 caracteres.</span> }
        </div>
      }
    </div>

    <div class="form-group">
      <label for="email">Email:</label>
      <input id="email" type="email" formControlName="email"
             [readonly]="isEditMode() && !funcionarioForm.get('email')?.pristine">
             @if (email?.invalid && (email?.dirty || email?.touched)) {
        <div class="form-error">
          @if (email?.errors?.['required']) { <span>Email é obrigatório.</span> }
@if (email?.errors?.['email']) { <span>Email deve ter um formato válido (ex: nome&#64;dominio.com).</span> }        </div>
      }
    </div>

    <div class="form-group">
      <label for="cargo">Cargo:</label>
      <input id="cargo" type="text" formControlName="cargo">

      @if (cargo?.invalid && (cargo?.dirty || cargo?.touched)) {
        <div class="form-error">
          @if (cargo?.errors?.['required']) { <span>Cargo é obrigatório.</span> }
        </div>
      }
    </div>

    <div class="form-group">
      <label for="salario">Salário:</label>
      <input id="salario" type="number" formControlName="salario" min="0.01" step="0.01">

      @if (salario?.invalid && (salario?.dirty || salario?.touched)) {
        <div class="form-error">
          @if (salario?.errors?.['required']) { <span>Salário é obrigatório.</span> }
          @if (salario?.errors?.['min']) { <span>Salário deve ser positivo e maior que zero.</span> }
        </div>
      }
    </div>

    <div class="form-group">
      <label for="dataAdmissao">Data de Admissão:</label>
      <input id="dataAdmissao" type="date" formControlName="dataAdmissao">

      @if (dataAdmissao?.invalid && (dataAdmissao?.dirty || dataAdmissao?.touched)) {
        <div class="form-error">
          @if (dataAdmissao?.errors?.['required']) { <span>Data de admissão é obrigatória.</span> }
          @if (dataAdmissao?.errors?.['dataFutura']) { <span>Data de admissão não pode ser posterior à data atual.</span> }
        </div>
      }
    </div>

    <div class="form-actions">
      <button class="btn-primary" type="submit" [disabled]="funcionarioForm.invalid || isLoading()">
        @if(isLoading()) { Salvando... } @else { Salvar }
      </button>
      <button class="btn-secondary" type="button" routerLink="/funcionarios">Cancelar</button>
    </div>

  </form>
}
